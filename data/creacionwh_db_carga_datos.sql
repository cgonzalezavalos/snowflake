CREATE OR REPLACE DATABASE ADP;

SELECT CURRENT_DATABASE(), CURRENT_SCHEMA();

CREATE OR REPLACE TABLE CONVOCATORIAS (
   Nivel STRING ,
   Adscrito STRING ,
   Ministerio STRING ,
   Servicio STRING ,
   Cargo STRING ,
   Mes STRING,
   Agno INTEGER,
   IdConcurso STRING
   );

CREATE OR REPLACE WAREHOUSE SC WITH
   WAREHOUSE_SIZE='X-SMALL'
   AUTO_SUSPEND = 180
   AUTO_RESUME = TRUE
   INITIALLY_SUSPENDED=TRUE;

SELECT CURRENT_WAREHOUSE();

PUT file://C:\Users\cgonzaleza\Desktop\python\WebDatosAbiertos\ADP\Publicaciones_ADP.csv @ADP.public.%CONVOCATORIAS;
LIST @ADP.public.%CONVOCATORIAS;

COPY INTO CONVOCATORIAS
  FROM @%CONVOCATORIAS
  FILE_FORMAT = (type = csv  
  FIELD_DELIMITER=';'
  ERROR_ON_COLUMN_COUNT_MISMATCH = FALSE
  ESCAPE_UNENCLOSED_FIELD ='"'
  ENCODING ="UTF-8" )
  PATTERN = 'Publicaciones_ADP.csv.gz'
  ON_ERROR ='CONTINUE';


SELECT * FROM CONVOCATORIAS